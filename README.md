
![IMAGE](https://github.com/leescot/NHITW_cloud_analyzer/blob/main/icon128.png)
# 健保雲端資料整理 Chrome Extension

這是一個專門用於整理健保雲端資料的 Chrome 擴充功能，可以協助醫療人員更有效率地處理和查看雲端藥歷和檢驗報告資料。

## 主要功能

### 1. 藥歷資料處理
- 自動解析並整理藥歷資料
- 支援藥品名稱精簡顯示
- 可顯示藥品學名
- 自動計算單次用藥劑量
- 支援多種複製格式（直式/橫式）

### 2. 檢驗報告處理
- 自動整理檢驗報告資料
- 支援檢驗值異常標示
- 可顯示檢驗單位和參考值
- 支援檢驗項目縮寫
- 提供直式/橫式顯示模式

### 3. 自動翻頁功能
- 支援自動翻頁查看歷史資料
- 可設定最大翻頁數量
- 具備暫停/繼續功能

### 4. 客製化設定
- 可調整顯示視窗大小
- 可自訂字型大小（標題/內容/備註）
- 支援多種顯示模式設定
- 可自訂檢驗縮寫對照表

## 安裝方式
(A) 正式發佈版: 於 Chrome extension store 頁面直接下載安裝

(B) 測試開發版: 於 GitHub 頁面下載
1. 下載擴充功能檔案
2. 開啟 Chrome 瀏覽器，進入擴充功能管理頁面 (`chrome://extensions/`)
3. 開啟右上角的「開發人員模式」
4. 點選「載入未封裝項目」
5. 選取擴充功能所在資料夾

## 使用說明
## 如何打開客製化設定頁面?
1. 打開擴充功能
2. 點擊健保雲端資料整理右邊三個點
3. 點擊選項
![Image](https://github.com/user-attachments/assets/23f8c5cf-92e0-44a1-8cee-ac2eae2792ae)
就會出現以下設定頁面
![Image](https://github.com/leescot/img/blob/main/NHI_analyzer_setting_01.png.jpg)

## 客製化設定功能說明
### 系統設定
#### 1. 進相關頁面時自動讀取資料並顯示視窗
* 建議勾選。適用頁面:藥物/檢驗/影像與病理。
* 〔開啟〕網頁進到藥物/檢驗/影像與病理頁面時，會自動跳出資料整理的視窗。
* 〔關閉〕網頁進到藥物/檢驗/影像與病理頁面時，不會自動跳出資料整理的視窗，使用者需按右上角”雲”圖示，才會跳出視窗。
  
#### ２. 開啟自動翻頁功能
* 建議勾選。適用頁面:藥物/檢驗。
* 〔開啟〕網頁進到藥物/檢驗頁面時，若讀取到不止一頁的資料(一頁資料是50筆)，會顯示「連續讀取」按鈕，可依照使用者設定的最大讀取頁面一次讀取，並顯示於視窗中。
* 〔關閉〕不會顯示「連續讀取」按鈕。
* 〔最大翻頁數量〕執行「連續讀取」的最大頁數。通常藥品頁面很少超過 5 頁，檢驗頁面預設是一年內資料，通常頁數較多。建議設 5~10 頁。

![image](https://github.com/leescot/img/blob/main/NHI_analyzer_setting_02.png.jpg)

#### 3. 字型大小
* 可設定資料整理視窗的標題/內容/備註的字型大小。建議設定: 標題 16px / 內容 14px / 備註 12 px。
  
#### 4. 視窗大小
* 可設定資料整理視窗的長與寬。建議設定: 寬(500px) / 高(80%)。

### 藥歷設定
#### 1. 藥物商品名精簡顯示
* 〔開啟〕藥品名稱會自動移除不必要的描述文字，例如劑型、單位等資訊，使名稱更簡潔易讀。
  - 範例：「RIVAROXABAN F.C. TABLETS 20MG "STAR"」→「RIVAROXABAN (20)」
* 〔關閉〕顯示完整的藥品商品名稱。
  
#### 2. 顯示主診斷資訊
* 〔開啟〕在每個處方日期下方顯示該次就醫的主要診斷名稱及診斷代碼。
  - 格式：「診斷名稱 (診斷代碼)」
* 〔關閉〕僅顯示就醫日期和來源，不顯示診斷資訊。

![image](https://github.com/leescot/img/blob/main/NHI_analyzer_setting_03.png.jpg)
  
#### 3. 顯示藥品學名
* 〔開啟〕在商品名稱下方以較小字體顯示藥品學名（成分名稱）。
* 〔關閉〕僅顯示藥品商品名稱。

![image](https://github.com/leescot/img/blob/main/NHI_analyzer_setting_06.jpg)

#### 4. 開啟藥物表格顯示
* 〔開啟〕提供表格化的藥物使用歷程檢視：
  - 此功能啟動的時機點：(1) 當藥物頁面只有一頁時; (2)當藥物頁面超過一頁，且已執行「連續讀取」後。
  - 縱軸：藥品名稱
  - 橫軸：就醫日期
  - 內容：包含用法用量及天數
  - 可依處方天數篩選顯示（全部/≧3天/≧7天/≧14天）
* 〔關閉〕以一般列表方式顯示藥物資訊。
* 註：需開啟自動翻頁功能才能顯示完整的用藥歷程。

![image](https://github.com/leescot/img/blob/main/NHI_analyzer_setting_07.jpg)

![image](https://github.com/leescot/img/blob/main/NHI_analyzer_setting_08.jpg)
  
#### 5. ATC5碼 藥品提示功能
* 〔開啟〕依據藥品的 ATC5 碼以不同背景顏色標示：
  - 紅色：NSAID類藥品（預設）
  - 藍色：使用者自訂分類1
  - 綠色：使用者自訂分類2
* 〔關閉〕不顯示顏色標示。
* 「管理 ATC5碼 顏色對照」功能：
  - 可自訂要以特定顏色標示的 ATC5 碼
  - 提供 ATC5 碼查詢連結
  - 註：需在表格欄位設定中新增「ATC5代碼」欄位
* 範例: A02BC 設為藍色 / B01AF 為綠色 / NSAID 內定為紅色

設定頁面:

![image](https://github.com/leescot/img/blob/main/NHI_analyzer_setting_04.jpg)

顯示結果:

![image](https://github.com/leescot/img/blob/main/NHI_analyzer_setting_05.jpg)

#### 6. 複製藥品格式
提供四種複製格式選項：
1. 關閉複製功能：移除複製按鈕
2. 複製商品名(直式)：
   ```
   日期 院所名稱
   藥品A
   藥品B
   藥品C
   ```
3. 複製商品名+使用量(直式)：
   ```
   日期 院所名稱
   藥品A 1# QD 7d
   藥品B 2# BID 14d
   藥品C 1# TID 28d
   ```
4. 複製商品名(橫式)：
   ```
   日期 院所名稱
   藥品A, 藥品B, 藥品C
   ```
5. 複製商品名+使用量(橫式)：
   ```
   日期 院所名稱
   藥品A 1# QD 7d, 藥品B 2# BID 14d, 藥品C 1# TID 28d

### 檢驗設定說明

#### 1. 顯示檢驗報告單位
* 〔開啟〕在檢驗值後方顯示測量單位。
  - 範例：「Glucose 95 mg/dL」
* 〔關閉〕僅顯示數值。
  - 範例：「Glucose 95」

#### 2. 異常檢驗值變色顯示
* 〔開啟〕依據參考值範圍，以不同顏色標示異常值：
  - 低於正常範圍：綠色字體
  - 高於正常範圍：紅色字體
  - 正常範圍內：黑色字體
* 〔關閉〕所有數值均以黑色字體顯示。

#### 3. 顯示檢驗參考值
* 〔開啟〕在檢驗結果後方顯示參考值範圍
  - 直式格式：「Glucose 95 mg/dL (參考值: 70-100)」
  - 橫式格式：「Glucose 95 mg/dL (70-100)」
* 〔關閉〕僅顯示檢驗結果，不顯示參考值。

#### 4. 檢驗值顯示方式
提供兩種顯示格式：
1. 直式顯示：
   ```
   日期 院所名稱
   檢驗項目1 95 mg/dL
   檢驗項目2 5.5 mmol/L
   檢驗項目3 14 g/dL
   ```
2. 橫式顯示：
   ```
   日期 院所名稱
   檢驗項目1 95 mg/dL, 檢驗項目2 5.5 mmol/L, 檢驗項目3 14 g/dL
   ```

#### 5. 常見檢驗項目縮寫
* 〔開啟〕使用預設或自訂的縮寫顯示檢驗項目名稱：
  - 預設縮寫例：
    - Cholesterol → Chol
    - Triglyceride → TG
    - Creatinine → Cr
  - 可透過「管理檢驗項目縮寫」新增或修改縮寫對照
* 〔關閉〕顯示完整的檢驗項目名稱。

#### 6. 檢驗表格顯示
* 〔開啟〕提供表格化的檢驗結果檢視：
  - 縱軸：檢驗項目名稱
  - 橫軸：檢驗日期
  - 可自訂：
    - 優先顯示項目（最多20項）
    - 檢驗項目統一顯示名稱
    - CBC、UA 項目顯示設定
  - 異常值自動標色
* 〔關閉〕以一般列表方式顯示檢驗結果。
* 註：需在表格欄位設定中開啟「醫令代碼」欄位。
  
### 基本操作
1. 進入健保雲端藥歷或檢驗報告頁面
2. 點擊右上角的擴充功能圖示
3. 資料會自動整理並顯示在右側視窗
4. 表格資料會顯示在左中側視窗

## 系統需求
- 需要健保雲端系統存取權限


